services:
  # GB28181 SIP服务器和流媒体服务器
  # 使用SRS GB28181版本作为测试服务器
  # 备选镜像（按优先级）:
  # 1. 7040210/gb28181:latest (原镜像)
  # 2. ossrs/srs:4 (官方SRS，需要GB28181支持)
  # 3. ossrs/srs:5 (官方SRS最新版)
  srs-gb28181:
    # 尝试使用原镜像，如果失败可以手动修改为其他镜像
    image: 7040210/gb28181:latest
    # 备选镜像（如果上面失败，取消注释下面一行并注释上面一行）:
    # image: ossrs/srs:4
    container_name: gb28181-srs
    platform: linux/amd64  # 指定平台以兼容ARM64 Mac
    ports:
      - "1986:1985"        # HTTP API端口（改为1986避免冲突）
      - "1936:1935"        # RTMP端口（改为1936避免冲突）
      - "9090:9090"        # HTTP端口（改为9090避免冲突）
      - "5062:5060/udp"    # SIP端口（改为5062避免冲突）
      - "30100-30200:30000-30100/udp"  # RTP端口范围（改为30100-30200避免冲突）
    environment:
      - TZ=Asia/Shanghai
    volumes:
      - ./gb28181-test-data/srs:/usr/local/srs/conf
      - ./gb28181-test-data/srs/html:/usr/local/srs/objs/nginx/html
    command: ["./objs/srs", "-c", "conf/srs.conf"]
    restart: unless-stopped
    network_mode: "bridge"
